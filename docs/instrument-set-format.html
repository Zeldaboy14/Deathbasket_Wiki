<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">

<!-- Mirrored from sites.google.com/site/deathbasketslair/zelda/instrument-set-format by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 22 Dec 2021 16:55:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { /*

Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/
(function(){function e(g){this.t={};this.tick=function(h,k,f){this.t[h]=[void 0!=f?f:(new Date).getTime(),k];if(void 0==f)try{window.console.timeStamp("CSI/"+h)}catch(m){}};this.getStartTickTime=function(){return this.t.start[0]};this.tick("start",null,g)}var a;if(window.performance)var d=(a=window.performance.timing)&&a.responseStart;var l=0<d?new e(d):new e;window.jstiming={Timer:e,load:l};if(a){var b=a.navigationStart;0<b&&d>=b&&(window.jstiming.srt=d-b)}if(a){var c=window.jstiming.load;0<b&&d>=
b&&(c.tick("_wtsrt",void 0,b),c.tick("wtsrt_","_wtsrt",d),c.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),c&&0<b&&(c.tick("_tbnd",void 0,window.chrome.csi().startE),c.tick("tbnd_","_tbnd",b))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,c&&0<b&&(c.tick("_tbnd",void 0,window.external.startE),c.tick("tbnd_","_tbnd",b))),a&&(window.jstiming.pt=a)}catch(g){}})(); })()
</script>
<link rel="shortcut icon" type="image/x-icon" href="images/sites-16.ico" />
<link rel="apple-touch-icon" href="images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { function d(a){return document.getElementById(a)}window.byId=d;function g(a){return a.replace(/^\s+|\s+$/g,"")}window.trim=g;var h=[],k=0;window.JOT_addListener=function(a,b,c){var f=new String(k++);a={eventName:a,handler:b,compId:c,key:f};h.push(a);return f};window.JOT_removeListenerByKey=function(a){for(var b=0;b<h.length;b++)if(h[b].key==a){h.splice(b,1);break}};window.JOT_removeAllListenersForName=function(a){for(var b=0;b<h.length;b++)h[b].eventName==a&&h.splice(b,1)};
window.JOT_postEvent=function(a,b,c){var f={eventName:a,eventSrc:b||{},payload:c||{}};if(window.JOT_fullyLoaded)for(b=h.length,c=0;c<b&&c<h.length;c++){var e=h[c];e&&e.eventName==a&&(f.listenerCompId=e.compId||"",(e="function"==typeof e.handler?e.handler:window[e.handler])&&e(f))}else window.JOT_delayedEvents.push({eventName:a,eventSrc:b,payload:c})};window.JOT_delayedEvents=[];window.JOT_fullyLoaded=!1;
window.JOT_formatRelativeToNow=function(a,b){a=((new Date).getTime()-a)/6E4;if(1440<=a||0>a)return null;var c=0;60<=a&&(a/=60,c=2);2<=a&&c++;return b?window.JOT_siteRelTimeStrs[c].replace("__duration__",Math.floor(a)):window.JOT_userRelTimeStrs[c].replace("__duration__",Math.floor(a))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/site/deathbasketslair/zelda","deleted":false,"title":"Zelda","dir":"ltr"},{"path":"/site/deathbasketslair/zelda/instrument-set-format","deleted":false,"title":"Instrument Set (Audiobank) Format","dir":"ltr"}];
  var JOT_clearDotPath = 'images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"gvizGstaticVersion":"current","enableAnalytics":false,"pageSharingId":"jotspot_page","codeembeds":{"outerIframeSrc":"https://www.gstatic.com/jotspot/embeds/code/0f08d42392f2000e7e3f3daf5b427a43/outer_iframe.html","innerIframeSrc":"https://696875360-jotspot-embeds.googleusercontent.com/code/8d87fa64604b2a11fae2ed06104c58d3/inner_iframe.html"},"enableUniversalAnalytics":false,"sharingPolicy":"OPENED","siteTitle":"DeathBasket's Lair","experiments":{"enableSubpagesGadgetInTakeout":true,"overrideDisableDomainEditing":false,"DisableSiteEditingFeature__disable_site_editing":true,"disableDomainEditing":true},"jot2atari":{"eligibility":"INELIGIBLE"},"onepickUrl":"https://docs.google.com/picker","adsensePublisherId":null,"features":{"moreMobileStyleImprovements":null,"subscriptionDataMigrationInProgress":null,"plusBadge":false},"configProperties":{"disableSiteEditing":null},"isPublic":true,"newSitesBaseUrl":"https://sites.google.com","isConsumer":true,"serverFlags":{"jot2AtariLearnMoreUrl":"https://support.google.com/sites/answer/7035197"},"domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://accounts.google.com/AccountChooser?continue=https://sites.google.com/site/deathbasketslair/zelda/instrument-set-format&service=jotspot","analyticsAccountId":"","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/65ef77/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/65ef77/system/js/codemirror.js","images/codemirror_css.css","images/trog_edit__en.js","images/trogedit.css","images/editor.css","images/codeeditor.css","/site/deathbasketslair/_/rsrc/1639038102000/system/app/css/camelot/editor-jfk.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"defaultdomain","baseUri":"/site/deathbasketslair","name":"deathbasketslair","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/zelda","parentWuid":"wuid:gx:d5a1d3e318b37ca","siteLocale":"en_GB","timeZone":"America/Los_Angeles","type":"text","title":"Instrument Set (Audiobank) Format","locale":"en","wuid":"wuid:gx:6e39bf9bedbd80ed","revision":19,"path":"/zelda/instrument-set-format","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"instrument-set-format","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false,"isGoogleAdmin":false},"gadgets":{"baseUri":"/site/deathbasketslair/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Instrument Set (Audiobank) Format - DeathBasket's Lair" />
<meta itemprop="name" content="Instrument Set (Audiobank) Format - DeathBasket's Lair" />
<meta property="og:title" content="Instrument Set (Audiobank) Format - DeathBasket's Lair" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="images/standard-css-glitter-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="images/overlayd461.css?cb=glitter4a150goog-ws-leftnone30themedefaultstandard" />
<link rel="stylesheet" type="text/css" href="images/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/site/deathbasketslair/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Instrument Set (Audiobank) Format - DeathBasket's Lair</title>
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en_GB            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><h2><a href="index.html" dir="ltr" id="sites-chrome-userheader-title">DeathBasket's Lair</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="https://sites.google.com/site/deathbasketslair/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_2bd" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Navigation</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList" class="has-expander"><li class="topLevel nav-first "><div dir="ltr" style="padding-left: 19px;"><a href="home.html" jotId="wuid:gx:2d93d154134c8417" class="sites-navigation-link topLevel">Welcome!</a></div></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="files.html" jotId="wuid:gx:765d6d1e3d204f9c" class="sites-navigation-link topLevel">Files</a></div></li><li class="topLevel parent " wuid="gx:26fcab0806616088"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="mario-golf.html" jotId="wuid:gx:26fcab0806616088" class="sites-navigation-link topLevel">Mario Golf</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="formatted-text-dump.html" jotId="wuid:gx:402ea47ea061666f" class="sites-navigation-link">Formatted text dump</a></div></li><li class="parent closed " wuid="gx:2ec4d2a02552cbd8"><div dir="ltr" style="padding-left: 19px;"><div class="expander"></div><a href="documentation.html" jotId="wuid:gx:2ec4d2a02552cbd8" class="sites-navigation-link">Game Documentation</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="compression.html" jotId="wuid:gx:7f828069a9a805ec" class="sites-navigation-link">Compression</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="hole-components.html" jotId="wuid:gx:7824c75248a24188" class="sites-navigation-link">Hole components</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="ram-functions.html" jotId="wuid:gx:562573259269c931" class="sites-navigation-link">RAM functions</a></div></li></ul></li></ul></li><li class="topLevel parent " wuid="gx:4d0cba5c661ecac6"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="programming.html" jotId="wuid:gx:4d0cba5c661ecac6" class="sites-navigation-link topLevel">Programming</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="collision-fixer.html" jotId="wuid:gx:3ed656f96c29d004" class="sites-navigation-link">Collision Fixer</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="ocarina-of-time-instrument-set-editor-oot-insted.html" jotId="wuid:gx:842afed270f4317" class="sites-navigation-link">Ocarina of Time instrument set editor (OoT InstEd)</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="ocarina-of-time-text-tool.html" jotId="wuid:gx:1833e7d5030c18a0" class="sites-navigation-link">Ocarina of Time Text Tool</a></div></li></ul></li><li class="topLevel parent " wuid="gx:d5a1d3e318b37ca"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="zelda.html" jotId="wuid:gx:d5a1d3e318b37ca" class="sites-navigation-link topLevel">Zelda</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="collision-normals.html" jotId="wuid:gx:5bae41658313eb7a" class="sites-navigation-link">Collision Normals</a></div></li><li class=""><div class="current-bg" jotId="wuid:gx:6e39bf9bedbd80ed" dir="ltr" style="padding-left: 38px;">Instrument Set (Audiobank) Format</div></li><li class="parent closed " wuid="gx:1a547ff7346d8d82"><div dir="ltr" style="padding-left: 19px;"><div class="expander"></div><a href="majoras-mask.html" jotId="wuid:gx:1a547ff7346d8d82" class="sites-navigation-link">Majora's Mask</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="actors-and-overlays.html" jotId="wuid:gx:4ddcac34bf35abb6" class="sites-navigation-link">Actors and Overlays</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="instrument-lists.html" jotId="wuid:gx:583df29ed9d895fb" class="sites-navigation-link">Instrument Lists</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="instrument-sets-and-sequences.html" jotId="wuid:gx:5d11b015d6e8c48" class="sites-navigation-link">Instrument Sets and Sequences</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="ram-notes.html" jotId="wuid:gx:296a4b4c7794e9b7" class="sites-navigation-link">RAM notes</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="switches-and-switch-actors.html" jotId="wuid:gx:5875bfc0f69bb274" class="sites-navigation-link">Switches and switch actors</a></div></li></ul></li><li class="parent closed " wuid="gx:6bc143c3255111ac"><div dir="ltr" style="padding-left: 19px;"><div class="expander"></div><a href="ocarina-of-time.html" jotId="wuid:gx:6bc143c3255111ac" class="sites-navigation-link">Ocarina of Time</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="audio-debugger.html" jotId="wuid:gx:7a4ab8836858c29f" class="sites-navigation-link">Audio Debugger</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="boss-rush-mode-hack.html" jotId="wuid:gx:a00615cf0dfb42e" class="sites-navigation-link">Boss Rush mode (Hack)</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="instrument-lists-2.html" jotId="wuid:gx:2956b2da2ae1b76f" class="sites-navigation-link">Instrument Lists</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="instrument-sets-and-sequences-2.html" jotId="wuid:gx:2334be7ed48f2ed" class="sites-navigation-link">Instrument Sets and Sequences</a></div></li></ul></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="sequenced-music-format.html" jotId="wuid:gx:4bef96da65133373" class="sites-navigation-link">Sequenced Music (Audioseq) Format</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="importance-of-hardware-compatibility.html" jotId="wuid:gx:4d920a3695e0eae" class="sites-navigation-link">The Importance of Hardware Compatibility</a></div></li></ul></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-embed-align-left-wrapping-off" id="COMP_5544886263087392" role="complementary"><div class="sites-embed-border-on sites-embed sites-embed-full-width" style="width:100%;"><div class="sites-embed-content sites-embed-type-countdown"><div aria-label="28499 days until I make the site not suck" class="sites-embed-countdown sites-embed-countdown-fromdateutc-2100-1-1"><span jotid="content"><p style="text-align: center"><strong aria-hidden="true" class="sites-embed-countdown-daysapart">28499</strong><span aria-hidden="true">days until </span><br aria-hidden="true" /><strong aria-hidden="true">I make the site not suck</strong></p></span></div></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="zelda.html" dir="ltr">Zelda</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Instrument Set (Audiobank) Format</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr">
<div>Note: This is currently WIP research so all information may not be correct.<div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Instrument-Set-Pointer-Table"><strong>1 </strong>Instrument Set Pointer Table</a></li><li class="goog-toc"><a href="#TOC-Instrument-Set-Format"><strong>2 </strong>Instrument Set Format</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Instrument-Indexes"><strong>2.1 </strong>Instrument Indexes</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Percussion"><strong>2.1.1 </strong>Percussion</a></li><li class="goog-toc"><a href="#TOC-Other-Instruments"><strong>2.1.2 </strong>Other Instruments</a></li></ol></li><li class="goog-toc"><a href="#TOC-Instrument-Properties"><strong>2.2 </strong>Instrument Properties</a></li><li class="goog-toc"><a href="#TOC-Unknown-Data-Structure"><strong>2.3 </strong>Unknown Data Structure</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Header"><strong>2.3.1 </strong>Header</a></li><li class="goog-toc"><a href="#TOC-Structure-1"><strong>2.3.2 </strong>Structure 1</a></li><li class="goog-toc"><a href="#TOC-Structure-2"><strong>2.3.3 </strong>Structure 2</a></li></ol></li></ol></li><li class="goog-toc"><a href="#TOC-Moving-Instruments-Between-Sets"><strong>3 </strong>Moving Instruments Between Sets</a></li><li class="goog-toc"><a href="#TOC-Moving-Audiobank-To-Another-Location"><strong>4 </strong>Moving Audiobank To Another Location</a></li><li class="goog-toc"><a href="#TOC-Super-Mario-64"><strong>5 </strong>Super Mario 64</a></li></ol></div></div></div></div></div>
<h2><a name="TOC-Instrument-Set-Pointer-Table"></a>Instrument Set Pointer Table</h2>
<div>This table can be found at <font face="courier new,monospace">0xBCC270</font> in the OoT Debug ROM. It begins with the number of instrument sets in the Audiobank file:</div>
<div> </div>
<div><font face="courier new,monospace">xxxx 0000 0000 0000 0000 0000 0000 0000</font></div>
<div> </div>
<div>xxxx = number of instrument sets.</div>
<div> </div>
<div>The rest of the data looks like:</div>
<div> </div>
<div><font face="courier new,monospace">xxxxxxxx yyyyyyyy zzzzzzzz nn aa bb cc</font></div>
<div> </div>
<div>xxxxxxxx = Pointer to the start of the instrument set within the Audiobank file.</div>
<div>yyyyyyyy = Size of the instrument set in bytes.</div>
<div>zzzzzzzz = To do with the way samples are loaded*</div>
<div>nn = Number of instruments to be read (can be less than total but not greater, does not include percussion).</div>
<div>aa/bb/cc = Flags of some sort, setting aa to <font face="courier new,monospace">0x40</font> enables percussion, 0 disables it.</div><div><br /></div><div>*The third bye is an index for a list at <font face="courier new, monospace">0xBCCD90</font><font face="arial, sans-serif"> which gives the base address to load samples from. What is the purpose of this? Well apparently just to be a pain in the arse, because taking these numbers and adding them to sample pointers will load that sample perfectly if the index is changed to 1, which has a base address of zero and is what most instrument sets use. Only four sets seem to actually do this though, namely the Deku Tree, Jabu-Jabu's belly, Goron City and the Spirit Temple. Super Mario 64 does something similar but it affects every single instrument set in the game.</font></div>
<div> </div>
<h2><a name="TOC-Instrument-Set-Format"></a>Instrument Set Format</h2>
<div>Because they are used individually, all pointers in an instrument set are relative to the start of the instrument set, <strong>not</strong> the start of Audiobank.</div>
<div>At the start of each instrument set you will find an array of 32-bit pointers that point to entries for each instrument index. If percussion is used then its pointer will usually come first and be followed by <font face="courier new,monospace">0x00000000</font>.</div>
<h3><a name="TOC-Instrument-Indexes"></a>Instrument Indexes</h3>
<h4><a name="TOC-Percussion"></a>Percussion</h4>
<div>Rather than pointing to an instrument index directly, percussion instruments point to an array of 32-bit pointers to instrument indexes in order to map different instruments to different notes. The format of these indexes looks like:</div>
<div> </div>
<div><font face="courier new,monospace">xxxxxxxx zzzzzzzz pppppppp yyyyyyyy</font></div>
<div> </div>
<div>x = Unknown.</div>
<div>zzzzzzzz = Pointer to unknown data structure.</div>
<div>pppppppp = Default sample pitch.</div>
<div>yyyyyyyy = Pointer to instrument properties.</div>
<h4><a name="TOC-Other-Instruments"></a>Other Instruments</h4>
<div>For other instruments the indexes appear differently:</div>
<div> </div>
<div><font face="courier new,monospace">uuvvwwxx yyyyyyyy [zzzzzzzz pppppppp]*</font></div>
<div><br /></div><div>u,v,w = note numbers to begin using different splits? A quick test seems to confirm this.</div>
<div>xx = Decay time?.</div>
<div>yyyyyyyy = Pointer to instrument properties.</div>
<div>zzzzzzzz = Pointer to unknown data structure.</div>
<div>pppppppp = Default sample pitch.</div>
<div>Note that <font face="courier new,monospace">[zzzzzzzz pppppppp]</font> appears three times but may just be zeroes. I'm not sure exactly how it is used if it appears more than once at the moment.</div>
<h3><a name="TOC-Instrument-Properties"></a>Instrument Properties</h3>
<div>This data is pointed to by the instrument indexes, I'm not sure of its format at the moment:</div>
<div> </div>
<div><font face="courier new,monospace">aaaa xxxx bbbb yyyy zzzz uuuu vvvv wwww</font></div>
<div> </div>
<div>All variables are unknowns but they affect the way the sample plays back. I haven't done enough testing to say for sure what they do.</div>
<h3><a name="TOC-Unknown-Data-Structure"></a>Unknown Data Structure</h3>
<h4><a name="TOC-Header"></a>Header</h4>
<div>The header identifies the sample and points to two other structures:</div>
<div> </div>
<div><font face="courier new,monospace">xxyyyyyy zzzzzzzz aaaaaaaa bbbbbbbb</font></div>
<div> </div>
<div>xx = Unknown.</div>
<div>yyyyyy = Size in bytes of sample.</div>
<div>zzzzzzzz = Pointer to sample location in Audiotable.</div>
<div>aaaaaaaa = Pointer to structure 2.</div>
<div>bbbbbbbb = Pointer to structure 1.</div>
<h4><a name="TOC-Structure-1"></a>Structure 1</h4>
<div>I have no idea what this data does, I haven't tried modifying it yet. It is nearly always 0x50 bytes long, the second word multiplied by 0x20 seems to give the length of data after that point.</div>
<h4><a name="TOC-Structure-2"></a>Structure 2</h4>
<div>Same case as above. This structure is nearly always 0x30 bytes long, if the first word is zero then it seems to be 0x10 bytes long.</div><div><br /></div><div>I haven't yet found a way of getting the length of these two structures automatically but it can be figured out by looking at their pointers and the location of other data in the file.</div>
<h2><a name="TOC-Moving-Instruments-Between-Sets"></a>Moving Instruments Between Sets</h2>
<div>If you can identify which instrument is mapped to each index then you should be able to move any instrument into any set. You will need to copy its index and unknown data structure and paste these over an instrument in a set that you wish to replace, remembering to fix any pointers that need changing.</div>
<h2><a name="TOC-Moving-Audiobank-To-Another-Location"></a>Moving Audiobank To Another Location</h2>
<div>If you're moving the Audiobank file, you will need to fix its entry in the file table and the assembly code used to load instrument sets, which is at <font face="courier new,monospace">0xB5A4C0</font> in the Debug ROM:</div>
<div> </div>
<div><font face="courier new,monospace">3C05 xxxx 24A5 yyyy</font></div>
<div> </div>
<div>Or in assembly code:</div>
<div><font face="courier new,monospace">LUI       $A1,xxxx</font></div>
<div><font face="courier new,monospace">ADDIU     $A1,$A1,yyyy</font></div>
<div> </div>
<div>xxxx = First half of address.</div>
<div>yyyy = Second half of address.</div>
<div>Remember that these numbers are signed so if yyyy is greater than <font face="courier new,monospace">0x7FFF</font> you need to add 1 to xxxx.</div><div><br /></div><div><br /></div><h2><a name="TOC-Super-Mario-64"></a>Super Mario 64</h2><div>Not all that relevant, I know, but might as well put the information here.</div><div><br /></div><div>The file that contains all of SM64's instrument sets starts at address <font face="courier new, monospace">0x57B720</font> in the decompressed ROM. It begins with two halfwords, one is unknown (0x0001) and the next is the number of instrument sets in the file (0x0026). There is then a list (0x0026*0x0008) bytes long that is a 32-bit pointer to an instrument set relative to the start of the file and then its size. The actual instrument sets starts 0x10 bytes after this pointer though, I don't know what the bytes at that address do.</div><div>The instrument set itself is nearly the same format as OoT uses, the only difference I know so far is that the header of 'Unknown data structure' is 0x20 bytes long. It will look something like:</div><div><br /></div><div><font face="courier new, monospace">00000000 xxxxxxxx aaaaaaaa bbbbbbbb</font></div><div><font face="courier new, monospace">yyyyyyyy 00000000 00000000 00000000</font></div><div><br /></div><div>x, is the sample address*</div><div>a is a pointer to data structure 2 (see above)</div><div>b is a pointer to data structure 1 (see above)</div><div>y is the size of the sample in bytes</div><div><br /></div><div>* this is not the real sample address. To get its actual address, you need to also find their base address which is in the game's sample file. This is found at <font face="courier new, monospace">0x593560</font> in the ROM.</div><div>The start of the sample file looks similar to the start of the instrument set file. Following the first two halfwords is a list of two 32-bit values, the first is the base address to load samples from (relative to the start of this file) and adding the second to the first gives the maximum address they can be loaded from (I think).</div><div>So, if you wanted to find the base address for samples in instrument set 0x11, you would go to 4+(set_number*8) = 4+(0x11*8) = 0x8C relative to the start of this file and read the 32-bit value there, which is <font face="courier new, monospace">0x001225A0</font>.</div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div id="sites-attachments-container">
</div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://accounts.google.com/ServiceLogin?continue=https://sites.google.com/site/deathbasketslair/zelda/instrument-set-format&amp;service=jotspot">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="reportabuse.html" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com/site">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="images/jot_min_view__en_gb.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">if (webspace.editorResources['text']) {webspace.editorResources['text'].unshift('#\/site\/deathbasketslair\/system\/app\/css\/overlay.css?cb\x3dglitter4a150goog-ws-leftnone30themedefaultstandard');webspace.editorResources['text'].unshift('#\/site\/deathbasketslair\/_\/rsrc\/1639038102000\/system\/app\/themes\/glitter\/standard-css-glitter-ltr-ltr.css');}</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/site/deathbasketslair/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("2bd", "Navigation", true);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_2bd');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([1109635200000, 1128902400000, 1130657000000, 1143333000000, 1143806400000, 1145000000000, 1146380000000, 1152489600000, 1159800000000, 1159500000000, 1162095000000, 1162075000000, 1162105500000]);
    gsites.Xhr.send('tz.html', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en_GB");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<script type="text/javascript">
          sites.codeembed.init();
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>

<!-- Mirrored from sites.google.com/site/deathbasketslair/zelda/instrument-set-format by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 22 Dec 2021 16:55:40 GMT -->
</html>
